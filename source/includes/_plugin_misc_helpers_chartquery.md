#### ChartQuery and Graphs

There are several classes available to assist with generating chart data.

```php
<?php
use Mautic\CoreBundle\Helper\Chart\LineChart;
use Mautic\CoreBundle\Helper\Chart\ChartQuery;

$chart = new LineChart($unit, $dateFrom, $dateTo, $dateFormat);
$query = new ChartQuery($this->em->getConnection(), $dateFrom, $dateTo);
$q     = $query->prepareTimeDataQuery('lead_points_change_log', 'date_added', $filter);
$data  = $query->loadAndBuildTimeData($q);
$chart->setDataset($this->translator->trans('mautic.point.changes'), $data);
$data  = $chart->render();
```
<div class="clear-right"></div>

##### ChartQuery

ChartQuery is a helper class to get the chart data from the database. Instantiate it with the Doctrine connection object, date from and date to. Those dates must be instances of the DateTime class. ChartQuery will automatically guess the time unit (hours, days, weeks, months or years) based on the items between the date range. However, if you want to receive the data from a specific time unit, pass it as the fourth parameter (H, d, W, m, Y).

ChartQuery also fills in the missing items (if any) which is required to display the data properly in the line chart generated by the [ChartJS](http://chartjs.org).

##### LineChart

LineChart is used in Mautic to display a date/time related data where the time is on the horizontal axis and the values are in the vertical axis. ChartJS' line charts can display multiple datasets in one chart. Instantiate the LineChart with a unit (null for unit guessing), from date, to date (the same as for the ChartQuery) and a date format (null for automatically generated date format).

All the params you need to instantiate the LineChart are used to generate the labels of the horizontal axis. To add the dataset to the LineChart object, use the `setDataset($label, $data)` method where the label is string and data is an array generated by the ChartQuery. The color of each dataset will be generated automatically.

Call the `render()` method to get the data prepared for ChartJS.

##### PieChart

A PieChart can be instantiated simply by `new PieChart()`. To add a dataset, use again the `setDataset($label, $value)` method where the label is a string and value is integer.

Call the `render()` method to get the data prepared for ChartJS.

##### BarChart

BarChart is used to display different variants of the same value where the variants are in the horizontal axis and the value is in vertical axis. To create a bar chart, use `new BarChart($labels)` where labels is an array of all the variants. Each variant can have multiple datasets. To add a dataset, use the `setDataset($label, $data, $order)` method where the label is string, data is array of values for each variant. Order can be used to move the dataset before already created dataset.

Call the `render()` method to get the data prepared for ChartJS.


```php
<?php echo $view->render('MauticCoreBundle:Helper:chart.html.php', array('chartData' => $data, 'chartType' => 'line', 'chartHeight' => 300)); ?>
```

##### Frontend

At the frontend, simply use the prepared chart template, pass in the chart data, the chart type (line/bar/pie) and the chart height. The width is responsive.
